\input{files/preamble.tex}

\begin{document}

% strona tytułowa
\input{files/title.tex}

% --------------------
\section{\bf Przygotowanie}

\subsection{\bf używane pakiety}
\begin{lstlisting}
using Plots
using Polynomials
using DataFrames
using Statistics
using Interpolations
\end{lstlisting}

\subsection{\bf przykładowe dane}
\begin{lstlisting}
# wylosowanie wezlow interpolacji
xs = 1:1:10
A = [rand() for x in xs]
# geste punkty do rysowania wykresow funkcji interpolujacych
xsf = 1:0.02:10
\end{lstlisting}

\subsection{\bf ilustracja}
\begin{center}
    \includegraphics[width=0.87\textwidth]{plot0.pdf}
\end{center}
\clearpage
% ----------------------------------
\section{\bf Wielomian interpolacyjny Lagrange’a}

\subsection{\bf wzory}
    . . .

\subsection{\bf kod}
\begin{lstlisting}
function lagrange_interpolation(xs, A)   
    n = size(A,1)
    P = Poly([0])
    for k = 1:n
        l = Poly([1.0])
        for i = 1:n
            if i != k
                l = l * poly([xs[i]]) / (xs[k] - xs[i])
            end
        end            
        P += (l * A[k])
    end
    P
end
\end{lstlisting}
\begin{lstlisting}
fit1 = lagrange_interpolation(xs, A)
B1 = [fit1(x) for x in xsf]
p1 = scatter(xs, A, label="data points")
plot!(xsf, B1, label="lagrange interpolation")
savefig(p1, "img/plot1.pdf")
\end{lstlisting}

\subsection{\bf wykres}
\begin{center}
    \includegraphics[width=0.95\textwidth]{plot1.pdf}
    \captionof{figure}{Interpolacja wielomianem Lagrange'a}
\end{center}
\clearpage
% ----------------------------------
\section{\bf Metoda Newtona (ilorazów róznicowych)}

\subsection{\bf wzory}
    . . .

\subsection{\bf kod}
\begin{lstlisting}
function newton_interpolation(xs, A, n)
    if n == 1
        Poly(float(A[1]))
    else
        prev = newton_interpolation(xs, A, n-1)
        p = A[n] - polyval(prev, xs[n])
        q = 1
        for i = 1:n-1
            q = q * (xs[n] - xs[i])
        end        
        poly([xs[i] for i in 1:n-1]) * (p / q) + prev
    end
end
\end{lstlisting}
\begin{lstlisting}
fit2 = newton_interpolation(xs, A, size(A,1))
B2 = [fit2(x) for x in xsf]
p2 = scatter(xs, A, label="data points")
plot!(xsf, B2, color=:orange, label="newton interpolation")
savefig(p2, "img/plot2.pdf")
\end{lstlisting}

\subsection{\bf wykres}
\begin{center}
    \includegraphics[width=0.97\textwidth]{plot2.pdf}
    \captionof{figure}{Interpolacja metodą Newtona}
\end{center}
\clearpage
% ----------------------------------

% spis tresci
\tableofcontents

\end{document}